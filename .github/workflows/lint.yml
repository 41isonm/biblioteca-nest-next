name: Lint Check

on:
  push:
    branches:
      - master      
      - develop  
  pull_request:
    branches:
      - main

jobs:
  lint:
    name: ğŸ§¹ Lint (ESLint + Prettier)
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¥ Checkout do cÃ³digo
        uses: actions/checkout@v4

      - name: ğŸŸ¢ Configurar Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20   
          cache: 'npm'       

      - name: ğŸ“¦ Instalar dependÃªncias (raiz + backend + frontend)
        run: |
          npm install            
          cd backend && npm install
          cd ../frontend && npm install

      - name: ğŸ” Lint Backend (NestJS)
        run: |
          cd backend
          npm run lint
        continue-on-error: false   

      - name: ğŸ” Lint Frontend (Next.js)
        run: |
          cd frontend
          npm run lint
        continue-on-error: false

      - name: âœ… VerificaÃ§Ã£o concluÃ­da
        if: success()
        run: echo "ğŸ‰ Lint passou com sucesso em backend e frontend!"

      - name: âŒ Lint falhou
        if: failure()
        run: |
          echo "ğŸš¨ Erros de lint encontrados!"
          echo "Corrija os problemas de estilo antes de mergear."
          exit 1